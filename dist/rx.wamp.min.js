(function(a){var b={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},c=b[typeof window]&&window||this,d=b[typeof exports]&&exports&&!exports.nodeType&&exports,e=b[typeof module]&&module&&!module.nodeType&&module,f=(e&&e.exports===d&&d,b[typeof global]&&global);!f||f.global!==f&&f.window!==f||(c=f),"function"==typeof define&&define.amd?define(["rx","autobahn","exports"],function(b,autobahn,d){return c.Rx=a(c,d,b),c.Rx}):"object"==typeof module&&module&&module.exports===d?module.exports=a(c,module.exports,require("rx"),require("autobahn")):c.Rx=a(c,{},c.Rx,c.autobahn)}).call(this,function(a,b,c,autobahn){var d=c.Observable,e=d.empty,f=d.fromPromise,g=(c.Observer,c.Subject),h=c.Disposable,i=c.CompositeDisposable,j=c.SerialDisposable,k=(autobahn.Session.prototype,function(){return"?.?.?"!==autobahn.version&&!!autobahn.Connection});return d.fromConnection=function(a,b){var c=k(),e=autobahn.CONNECTION_CLOSED||"closed",f=autobahn.CONNECTION_UNREACHABLE||"unreachable",g=autobahn.CONNECTION_LOST||"lost",h=autobahn.Connection||function(a){this.uri=a.uri;var b=new j;this._onopen=function(a){b.setDisposable(function(){a.close()}),!b.isDisposed&&this.onopen&&this.onopen(a)},this.open=function(){autobahn.connect(this.uri,this._onopen,this.onclose,a)},this.close=function(){b.dispose()},this.onopen=null,this.onclose=null},i=new h(a);return d.create(function(a){return i.onopen=function(b){a.onNext(b)},i.onclose=function(d,h,i){var j=d,k=c?j:h,i=c?h:i;switch(d){case f:a.onError({reason:k,details:i,code:j});break;case g:if(!b.isDisposed)return!0;a.onCompleted();break;case e:default:a.onCompleted()}},i.open(),function(){i&&i.close()}})},d.fromPubSubPattern=function(a,b,e,f){var h=d.subscribeAsObservable(a,b,e,f),i=c.Observer.create(function(c){d.publishAsObservable(a,b,c.args||c.event,c.kwargs,c.options)});return g.create(i,h)},d.subscribeAsObservable=function(a,b,e,g){return d.create(function(h){g=g||c.Observer.create();var l=new j,m=k()?function(a,b,c){h.onNext({args:a,kwargs:b,details:c})}:function(a,b){h.onNext({topic:a,event:b})},n=a.subscribe(b,m,e),o=n?function(b){a.unsubscribe(b)}:function(b){a.unsubscribe(b.topic,b.handler)},p=n?f(n):d.just({topic:b,handler:m});return new i(l,p.subscribe(g),p.subscribe(function(b){l.setDisposable(o.bind(a,b))},h.onError.bind(h)))})},d.publishAsObservable=function(a){var b=a.publish.apply(a,Array.prototype.slice.call(arguments,1));return b?f(b):e()},d.registerAsObservable=function(a,b,c,e){function g(b){a.unregister(b)}return d.create(function(d){var k=new j,l=f(a.register(b,c,e));return new i(k,l["do"](function(a){k.setDisposable(h.create(g.bind(null,a)))}).subscribe(d))})},d.callAsObservable=function(a,b,c){var d=[b];return function(){return d=d.concat(arguments),c&&d.push(c),f(a.call.apply(a,d))}},c});
//# sourceMappingURL=rx.wamp.map