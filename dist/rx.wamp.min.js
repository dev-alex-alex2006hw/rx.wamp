(function(a){var b={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},c=b[typeof window]&&window||this,d=b[typeof exports]&&exports&&!exports.nodeType&&exports,e=b[typeof module]&&module&&!module.nodeType&&module,f=(e&&e.exports===d&&d,b[typeof global]&&global);!f||f.global!==f&&f.window!==f||(c=f),"function"==typeof define&&define.amd?define(["rx","autobahn","exports"],function(b,autobahn,d){return c.Rx=a(c,d,b,autobahn),c.Rx}):"object"==typeof module&&module&&module.exports===d?module.exports=function(b){return b||(b=require("autobahn")),a(c,module.exports,require("rx"),b)}:c.Rx=a(c,{},c.Rx,c.autobahn)}).call(this,function(a,b,c,autobahn){function d(a){return new autobahn._connection_cls(a)}var e=c.Observable,f=e.empty,g=e.fromPromise,h=(c.Observer,c.Subject),i=c.Disposable,j=c.CompositeDisposable,k=c.SerialDisposable,autobahn=autobahn||ab,l=(autobahn.Session.prototype,function(){return"function"!=typeof autobahn.version||"?.?.?"!==autobahn.version()&&!!autobahn.Connection});return autobahn._connection_cls=autobahn.Connection||function(a){this.uri="object"==typeof a?a.url:a;var b=new k;this._onopen=function(a){b.setDisposable(i.create(function(){a.close()})),!b.isDisposed&&this.onopen&&this.onopen(a)},this.open=function(){autobahn.connect(this.uri,this._onopen.bind(this),this.onclose,a)},this.close=function(){b.dispose()},this.onopen=null,this.onclose=null},e.fromConnection=function(a,b,c){var f=l(),g=autobahn.CONNECTION_CLOSED||"closed",h=autobahn.CONNECTION_UNREACHABLE||"unreachable",i=autobahn.CONNECTION_LOST||"lost",j=(c||d)(a);return e.create(function(a){return j.onopen=function(b){a.onNext(b)},j.onclose=function(c,d,e){var j=c,k=f?j:d,e=f?d:e;switch(c){case h:a.onError({reason:k,details:e,code:j});break;case i:if(!b.isDisposed)return!0;a.onCompleted();break;case g:default:a.onCompleted()}},j.open(),function(){j&&j.close()}})},e.fromPubSubPattern=function(a,b,d,f){var g=e.subscribeAsObservable(a,b,d,f),i=c.Observer.create(function(c){e.publishAsObservable(a,b,c.args||c.event,c.kwargs,c.options)});return h.create(i,g)},e.subscribeAsObservable=function(a,b,c,d){return e.create(function(f){var h=new j,m=new k,n=l()?function(a,b,c){var d={};a&&(d.args=a),b&&(d.kwargs=b),c&&(d.details=c),f.onNext(d)}:function(a,b){f.onNext({topic:a,event:b})},o=a.subscribe(b,n,c),p=o?function(b){a.unsubscribe(b)}:function(b){a.unsubscribe(b.topic,b.handler)},q=o?g(o):e.just({topic:b,handler:n});return d&&h.add(q.subscribe(d)),h.add(m),h.add(q.subscribe(function(b){m.setDisposable(i.create(p.bind(a,b)))},f.onError.bind(f))),h})},e.publishAsObservable=function(a){var b=a.publish.apply(a,Array.prototype.slice.call(arguments,1));return b?g(b):f()},e.registerAsObservable=function(a,b,c,d){function f(b){a.unregister(b)}return e.create(function(e){var h=new k,l=g(a.register(b,c,d));return new j(h,l["do"](function(a){h.setDisposable(i.create(f.bind(null,a)))}).subscribe(e))})},e.callAsObservable=function(a,b,c){var d=[b];return function(){return d=d.concat(Array.prototype.slice.call(arguments)),c&&d.push(c),g(a.call.apply(a,d))}},c});
//# sourceMappingURL=rx.wamp.map